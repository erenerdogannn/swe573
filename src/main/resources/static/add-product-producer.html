<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Uni Koop</title>


<!-- CSS -->
<link href="/assets/stylesheets/bootstrap.min.css" rel="stylesheet">
<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="stylesheet" href="/assets/stylesheets/jquery.dataTables.tableTools.min.css" type="text/css">
<link rel="stylesheet" href="/assets/stylesheets/font-awesome.min.css">
<link rel="stylesheet" href="/assets/stylesheets/main.css" type='text/css'>
<link rel="stylesheet" href="/assets/stylesheets/select2.css" type='text/css'>
<link rel="stylesheet" href="/assets/stylesheets/bootstrap-select.min.css" type="text/css">
<link rel="stylesheet" href="/assets/stylesheets/jquery.fileupload.css" type="text/css">
<link rel="stylesheet" href="/assets/stylesheets/datatables.min.css" type="text/css">
<link rel="stylesheet" href="/assets/stylesheets/bootstrap-multiselect.css" type="text/css">

</head>

<body class="preload body-panel">

<div class="panel-wrapper">

    <!-- SIDEBAR -->
    <div class="panel-sidebar-hide-wrapper">
        <figure class="arrow-down"></figure>
        <div class="panel-sidebar-wrapper">
            <ul class="panel-sidebar-holder">
                <li class="panel-sidebar-item first">
                    <a href="index.html">
                        <figure class="logo">
                        </figure>
                    </a>
                </li>
                <li class="panel-sidebar-item">
                    <a href="volunteer.html">
                        <figure id=""></figure>
                        <h5>GÖNÜLLÜ OL</h5>
                    </a>
                </li>
                <li class="panel-sidebar-item volunteer-sidebar">
                    <a class="current" href="add-product-producer.html">
                        <figure id=""></figure>
                        <h5>ÜRÜN/ÜRETİCİ EKLE</h5>
                        <span class="arrow"></span>
                    </a>
                </li>
                <li class="panel-sidebar-item volunteer-sidebar">
                    <a href="pos.html">
                        <figure id=""></figure>
                        <h5>POS</h5>
                    </a>
                </li>
                <li class="panel-sidebar-item volunteer-sidebar">
                    <a href="sales-report.html">
                        <figure id=""></figure>
                        <h5>SATIŞ RAPORU</h5>
                    </a>
                </li>
                <li class="panel-sidebar-item volunteer-sidebar">
                    <a href="inventory-report.html">
                        <figure id=""></figure>
                        <h5>STOK RAPORU</h5>
                    </a>
                </li>
                <li class="panel-sidebar-item admin-sidebar">
                    <a href="create-workslot.html">
                        <figure id=""></figure>
                        <h5>İŞ YARAT</h5>
                    </a>
                </li>
                <li class="panel-sidebar-item admin-sidebar">
                    <a href="create-event.html">
                        <figure id=""></figure>
                        <h5>ETKİNLİK YARAT</h5>
                    </a>
                </li>
                <li class="panel-sidebar-item admin-sidebar">
                    <a href="create-announcement.html">
                        <figure id=""></figure>
                        <h5>DUYURU YARAT</h5>
                    </a>
                </li>
                <li class="panel-sidebar-item admin-sidebar">
                    <a href="admin.html">
                        <figure></figure>
                        <h5>ADMIN</h5>
                    </a>
                </li>

            </ul>
        </div>
    </div>
    <div class="sidebar-user-holder dropdown">
        
        <!-- Kullanıcı loginse current class'ı koy -->
        <a class="sidebar-user-item"  href="#"data-toggle="dropdown">
            <h5><i class="fa fa-cog"></i> Hesabım</h5>
        </a>

        <ul class="dropdown-menu not-slide not-close sidebar-user-dropdown">
            <span class="arrow-icon"></span>

            <div class="user-account-holder">
                <!-- <p class="user-name">Eren Erdoğan</p> -->
                <a href="settings.html"
                   class="button button-verythin a button-blue  button-xs right user-account-button">
                    Ayarlar</a>
            </div>

            <div class="user-usage-holder">

                <!--
                <p class="user-usage-project-number">Clicks</p>

                <p class="user-usage-project-usage">Estimate</p>
                -->
            </div>

            <div class="user-logout-holder">
                <a id="sign-out-btn"
                   class="button button-verythin a button-red  button-xs right user-logout-button">Çıkış Yap</a>
            </div>


        </ul>
    </div>
    <!-- END OF SIDEBAR -->

    <div class="panel-content-wrapper without-header">
        <div class="panel-content-holder without-header">

            <!-- ALERTS

            <div class="alert alert-danger" role="alert">
                <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span
                            class="sr-only">Close</span></button>
                <strong>Error!</strong>
            </div>
            <div class="alert alert-success" role="alert">
                <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span
                            class="sr-only">Close</span></button>
                <strong>Success!</strong>
            </div>

            <div class="alert alert-warning" role="alert">
                <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span
                            class="sr-only">Close</span></button>
                <strong>Warning!</strong> 
            </div>

            END OF ALERTS -->
            
            <div class="panel-content-widget xlg border-bottom ">
                <ul class="panel-content-heading-holder">
                    <li class="panel-content-heading-item"><a href="#" class="current">
                            Ürün Üretici Ekle</a></li>
                </ul>
            </div>
            
            <div class="panel-content-widget xlg">
                <div class="tab-wrapper">
                    <ul class="tab-holder">
                        <li class="tab-item  active"><a href="#info-content" data-toggle="tab">Ürün Ekle</a></li>
                        <li class="tab-item"><a href="#domains-content" data-toggle="tab">Üretici Ekle</a></li>
                    </ul>
                </div>
            </div>
            <div class="tab-content">

                <div id="info-content" class="xlg tab-pane fade in active ">
                    
                    <form id="add-product" class="settings-info-holder" onsubmit="return validateAddProductForm()">
                        <div class="settings-form-item">
                            <label class="form-label">Üretici*</label>
                            <select id="product-producer" class="form-text" style="width: 30%;">
                            </select>
                        </div>
                        <div class="settings-form-item">
                            <label class="form-label">Ürün Adı*</label>
                            <input id="product-name" class="form-text" name="" value="" required>
                        </div>
                        <div class="settings-form-item">
                            <label class="form-label">Yöre</label>
                            <input id="product-region" class="form-text " name="" value="" required>
                        </div>
                        <div class="settings-form-item">
                            <label class="form-label">Açıklama</label>
                            <input id="product-info" class="form-text " name="" value="">
                        </div>
                        <div class="settings-form-item">
                            <label class="form-label">Ürün Kategorisi*</label>
                            <select id="product-category" class="form-text" name="" style="width: 30%;">
                                <option value='' title=''>Seçiniz</option>
                                <option value='1' title='Taze Meyveler'>Taze Meyveler</option>
                                <option value='2' title='Taze Sebzeler'>Taze Sebzeler</option>
                                <option value='3' title='Yeşillikler'>Yeşillikler</option>
                                <option value='4' title='Kahvaltılık Ürünler'>Kahvaltılık Ürünler</option>
                                <option value='5' title='Zeytin ve Zeytinyağı'>Zeytin ve Zeytinyağı</option>
                                <option value='6' title='Salça ve Soslar'>Salça ve Soslar</option>
                                <option value='7' title='Kuru Gıdalar'>Kuru Gıdalar</option>
                                <option value='8' title='Yeşillikler'>Et Tavuk ve Balık</option>

                            </select>
                        </div>                        
                        <div class="settings-form-item">
                            <label class="form-label">Ölçü Birimi</label>
                            <select id="product-measurement" class="form-text" name="" style="width: 30%;">
                                <option value='kg' title='kg'>kg</option>
                                <option value='gr' title='gr'>gr</option>
                                <option value='lt' title='lt'>lt</option>
                            </select>
                        </div>
                        <div class="settings-form-item">
                            <label class="form-label">Paketli*</label>
                            <select id="product-ispackaged" class="form-text" name="" style="width: 30%;" onchange="getVal(this)">
                                <option value='empty' title=''>Seçiniz</option>
                                <option value='yes' title=''>Evet</option>
                                <option value='no' title=''>Hayır</option>
                            </select>
                        </div>
                        <div class="settings-form-item product-packaged product-package-size-container noshow">
                            <label class="form-label">Paket Büyüklüğü</label>
                            <input id="product-package-size" class="form-text" name="" value="" type="number">
                        </div>
                        <div class="settings-form-item product-packaged product-num-package-container noshow">
                            <label class="form-label">Paket Sayısı*</label>
                            <input id="product-num-package" class="form-text" name="" value="" type="number">
                        </div>
                        <div class="settings-form-item product-nonpackaged product-total-amount-container noshow">
                            <label class="form-label">Toplam Ürün Miktarı*</label>
                            <input id="product-total-amount" class="form-text" name="" value="" type="number">
                        </div>
                        <div class="settings-form-item product-nonpackaged product-price-container">
                            <label class="form-label">Birim Fiyatı*</label>
                            <input id="product-unit-price" class="form-text" name="" value="" type="number" required>
                        </div>
                        <div class="settings-form-item">
                            <label class="form-label">Ürün Resmi</label>
                            <input type="file" id="productPic" name="files[]" multiple style="display: inline;"/>  
                        </div>
                        
                        <div class="panel-content-widget xlg">
                            <!-- EMPTY PLACE-->
                        </div>
                        <div class="panel-content-widget xlg">
        <button id="add-product-btn" class="button button-green button-md center" type="button">Ürün Ekle</button>
                        </div>
                    </form>
                    
                </div>


                <div id="domains-content" class="xlg tab-pane fade ">
                    
                     <form id="add-producer" class="settings-info-holder" onsubmit="return validateAddProducerForm()">
                        <div class="settings-form-item">
                            <label class="form-label">Üretici Adı*</label>
                            <input id="producer-name" class="form-text" name="" value="" required>
                        </div>
                        <div class="settings-form-item">
                            <label class="form-label">Üretici Yeri</label>
                            <input id="producer-place" class="form-text" name="" value="" required>
                        </div>
                        <div class="settings-form-item">
                            <label class="form-label">Üretici Açıklama</label>
                            <input id="producer-info" class="form-text" name="" value="">
                        </div>
                        <div class="settings-form-item">
                            <label class="form-label">Üretici Resmi</label>
                            <input type="file" id="producerPic" name="files[]" multiple style="display: inline;"/>  
                        </div>

                        <div class="panel-content-widget xlg">
                            <!-- EMPTY PLACE-->
                        </div>
                        <div class="panel-content-widget xlg">
                            <button class="button button-green button-md center" type="button" id="addProducer">Üretici Ekle</button>
                        </div>
                    </form>
                    
                </div>
            </div>
        <div class="panel-content-widget xlg"></div>
        <div class="panel-content-widget xlg"></div>
        </div>
        
    </div>
</div>


<script src="/assets/javascript/jquery-2.1.1.min.js"></script>
<script src="/assets/javascript/bootstrap.min.js"></script>
<script src="/assets/javascript/select2.min.js"></script>
<script src="/assets/javascript/jquery.multiple.select.min.js"></script>
<script src="/assets/javascript/moment-with-locales.min.js"></script>
<script src="/assets/javascript/moment-timezone-with-data-2010-2020.min.js"></script>
    <script src="/assets/javascript/daterangepicker.min.js"></script>
<script src="/assets/javascript/highcharts-custom.min.js"></script>
<script src="/assets/javascript/map.js"></script>
<script src="/assets/javascript/datatables.min.js"></script>
<script src="/assets/javascript/jquery.dataTables.tableTools.min.js"></script>
<script src="/assets/javascript/jspath.min.js"></script>
<script src="/assets/javascript/jdata.js"></script>
<script src="/assets/javascript/main.js"></script>
<script src="/assets/javascript/pace.min.js"></script>
<script src="/assets/javascript/mappings.js"></script>
<script src="/assets/javascript/jquery.ui.widget.js"></script>
<script src="/assets/javascript/bootstrap-select.min.js"></script>
<script src="/assets/javascript/jquery.iframe-transport.js"></script>
<script src="/assets/javascript/jquery.fileupload.js"></script>
<script src="/assets/javascript/easytimer.min.js"></script>
<script src="/assets/javascript/bootstrap-multiselect.js"></script>
<script src="/assets/javascript/bootstrap-tagsinput.min.js"></script>

<script>
    // Array Remove - By John Resig (MIT Licensed)
    Array.prototype.remove = function (from, to) {
        var rest = this.slice((to || from) + 1 || this.length);
        this.length = from < 0 ? this.length + from : from;
        return this.push.apply(this, rest);
    };
</script>

    
<script>
    
    $(window).load(function() {

        $.getJSON( urlRoot + "/producers", 
            function (data) {
            
                $.each( data, function( key, val ) {
                $('#product-producer').append( "<option value='" + val.id + "'>" + val.name + "</option>" );
                });
                
            }
        )
        
    });
    
    $('#addProducer').on('click', function(){
        
        var producerName = $('#producer-name').val();
        var producerRegion = $('#producer-place').val();
        var producerInfo = $('#producer-info').val();
        var producerImg;
        
        if (producerImage.length > 0) {
            producerImg = producerImage;
        } else {
            producerImg = "";
        }
        
        if (producerName.length > 0) {
            
            $.ajax({
                headers: { 
                'Accept': 'application/json',
                'Content-Type': 'application/json' 
                },
                type: "POST",
                url: urlRoot + "/producers/add",

                data: JSON.stringify({
                    name: producerName,
                    region: producerRegion,
                    info: producerInfo,
                    photoURL: producerImg

                }),
                dataType:"json",
                success: function (html) {
                    alert('Üretici başarıyla eklendi.');
                    window.location.reload(true);
                },
                 error: function (xhr, textStatus, thrownError) {
                    alert(textStatus, thrownError);
                     alert('Hata meydata geldi.');
                }
            });
                
        } else {
            alert('Yıldızla işaretlenen yerler boş bırakılamaz.');
        }
        
        
        
    });
    

    
    $('#add-product-btn').on('click', function(){
        
        var prodName = $('#product-name').val();
        var prodRegion = $('#product-region').val();
        var prodInfo = $('#product-info').val();
        var prodCategory = $('#product-category').val();
        var prodMeasurement = $('#product-measurement').val();
        var prodProducer = $('#product-producer').val();
        var isPkg = $('#product-ispackaged').val();
        var pkgSize = $('#product-package-size').val();
        var numPkg = $('#product-num-package').val();
        var amount = $('#product-total-amount').val();
        var prc = $('#product-unit-price').val();
        var prodProducer = $('#product-producer').val();
        var prodImg;
        
        if (productImage.length > 0) {
            prodImg = productImage;
        } else {
            prodImg = "";
        }
        
        if (prodProducer != null || prodProducer != "") {
            
            if (prodName == null || prodName == "" || prc == null || prc == "" || ( numPkg == 0 && amount == 0) || prodCategory == "" || prodCategory == null) {
                alert('Yıldızla işaretlenen yerler boş bırakılamaz.');
                
            } else {
                
                $.ajax({
                    headers: { 
                    'Accept': 'application/json',
                    'Content-Type': 'application/json' 
                    },
                    type: "POST",
                    url: urlRoot + "/products/add",

                    data: JSON.stringify({
                        name: prodName,
                        region: prodRegion,
                        info: prodInfo,
                        category: prodCategory,
                        measurement: prodMeasurement,
                        isPackaged: isPkg,
                        packageSize :  pkgSize,
                        numOfPackage: numPkg,
                        totalAmount: amount,
                        price: prc,
                        photoURL: prodImg,
                        producer: {
                            id: prodProducer
                        }
                    }),
                    dataType:"json",
                    success: function (html) {
                        alert('Ürün başarıyla eklendi.');
                        window.location.reload(true);
                    },
                    error: function (xhr, textStatus, errorThrown) {
                        console.log(textStatus, errorThrown);
                        alert('Hata meydana geldi.')
                    }
                });
            }
        
            
        } else {
            alert('Önce üretici yaratmalısınız.');
            return false
        }
        
    })
    
    
    var producerImage = "";
    
     function handleFileSelectProducer(evt) {
        var files = evt.target.files; // FileList object

        // Loop through the FileList and render image files as thumbnails.
        for (var i = 0, f; f = files[i]; i++) {

          // Only process image files.
          if (!f.type.match('image.*')) {
            continue;
          }
          var reader = new FileReader();

          // Closure to capture the file information.
          reader.onload = (function(theFile) {
            return function(e) {
              // Render thumbnail.
              producerImage = e.target.result;
              localStorage.setItem('img', e.target.result);
            };
          })(f);

          // Read in the image file as a data URL.
          reader.readAsDataURL(f);
        }
      }
    
    document.getElementById('producerPic').addEventListener('change', handleFileSelectProducer, false);

    
    var productImage = "";

     function handleFileSelectProduct(evt) {
        var files = evt.target.files; // FileList object

        // Loop through the FileList and render image files as thumbnails.
        for (var i = 0, f; f = files[i]; i++) {

          // Only process image files.
          if (!f.type.match('image.*')) {
            continue;
          }
          var reader = new FileReader();

          // Closure to capture the file information.
          reader.onload = (function(theFile) {
            return function(e) {
              // Render thumbnail.
              productImage = e.target.result;
              localStorage.setItem('img', e.target.result);
            };
          })(f);

          // Read in the image file as a data URL.
          reader.readAsDataURL(f);
        }
      }

    document.getElementById('productPic').addEventListener('change', handleFileSelectProduct, false);
        
    
    
</script>
</body>
</html>